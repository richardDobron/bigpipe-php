(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{68:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(1),r=n(6),i=(n(0),n(82)),s={id:"how_it_works",title:"How it works",sidebar_label:"How it works"},o={unversionedId:"how_it_works",id:"how_it_works",isDocsHomePage:!1,title:"How it works",description:"The BigPipe integration works by utilizing the dobron\\BigPipe\\AsyncResponse class to process requests and generate the defined instructions. These instructions are then handled by the ServerJS class on the frontend. The required Primer module registers essential event listeners, such as click and submit, for elements with the rel attribute.",source:"@site/..\\docs\\how_it_works.md",slug:"/how_it_works",permalink:"/bigpipe-php/docs/how_it_works",version:"current",lastUpdatedBy:"Richard Dobro\u0148",lastUpdatedAt:1693950955,sidebar_label:"How it works",sidebar:"docs",previous:{title:"Integrating into your app",permalink:"/bigpipe-php/docs/getting_started"},next:{title:"\ud83e\ude84 DOMOPS API",permalink:"/bigpipe-php/docs/domops"}},c=[{value:"Usage example",id:"usage-example",children:[]},{value:"Request API",id:"request-api",children:[]},{value:"What all can be Ajaxifed?",id:"what-all-can-be-ajaxifed",children:[{value:"Links",id:"links",children:[]},{value:"Forms",id:"forms",children:[]},{value:"Dialogs",id:"dialogs",children:[]}]}],l={rightToc:c};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The BigPipe integration works by utilizing the ",Object(i.b)("inlineCode",{parentName:"p"},"dobron\\BigPipe\\AsyncResponse")," class to process requests and generate the defined instructions. These instructions are then handled by the ",Object(i.b)("inlineCode",{parentName:"p"},"ServerJS")," class on the frontend. The required ",Object(i.b)("inlineCode",{parentName:"p"},"Primer")," module registers essential event listeners, such as click and submit, for elements with the ",Object(i.b)("inlineCode",{parentName:"p"},"rel")," attribute."),Object(i.b)("p",null,"To make ",Object(i.b)("inlineCode",{parentName:"p"},"XHR")," (XMLHttpRequest) requests, you can use the ",Object(i.b)("inlineCode",{parentName:"p"},"AsyncRequest")," JavaScript class. It allows you to send requests to the server and receive responses, similar to using the native ",Object(i.b)("inlineCode",{parentName:"p"},"fetch")," method. These responses are automatically processed and executed through BigPipe. However, it's important to note that the response on the backend must always be sent using the ",Object(i.b)("inlineCode",{parentName:"p"},"AsyncResponse")," class."),Object(i.b)("h2",{id:"usage-example"},"Usage example"),Object(i.b)("p",null,"Here's a step-by-step example of how to use BigPipe to display an alert with the name of the user who just logged in:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Create the file ",Object(i.b)("inlineCode",{parentName:"p"},"UserLoggedInAlert.js"),":"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"export default function UserLoggedInAlert(username) {\n    alert(`Welcome, ${username}!`);\n}\n"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Require the module on backend:"),Object(i.b)("p",{parentName:"li"},"In your PHP backend code, use the ",Object(i.b)("inlineCode",{parentName:"p"},"dobron\\BigPipe\\AsyncResponse")," class to require the module and pass arguments:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"<?php\n$asyncResponse = new \\dobron\\BigPipe\\AsyncResponse();\n\n$asyncResponse->bigPipe()->require(\"require('UserLoggedInAlert')\", [\n    'Marvin', // username argument\n]);\n\n// If this request was made via AsyncRequest, call the send() method\n$asyncResponse->send();\n")))),Object(i.b)("h2",{id:"request-api"},"Request API"),Object(i.b)("p",null,"In your frontend JavaScript, you can use the ",Object(i.b)("inlineCode",{parentName:"p"},"AsyncRequest")," class to send XHR requests."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"import AsyncRequest from 'bigpipe-util/src/AsyncRequest';\n\nconst request = (new AsyncRequest('/ajax/remove.php'))\n  // or .setURI('/ajax/remove.php')\n  .setMethod('POST')\n  .setData({\n    param: 'value',\n  })\n  .setInitialHandler(() => {\n      // pre-request callback function\n  })\n  .setHandler((jsonResponse) => {\n      // A function to be called if the request succeeds\n  })\n  .setErrorHandler((xhr) => {\n      // A function to be called if the request fails\n  })\n  .setFinallyHandler((xhr) => {\n      // after request callback function\n  })\n  .send();\n\nif (OH_NOES_WE_NEED_TO_CANCEL_RIGHT_NOW_OR_ELSE) {\n  request.abort();\n}\n")),Object(i.b)("h2",{id:"what-all-can-be-ajaxifed"},"What all can be Ajaxifed?"),Object(i.b)("p",null,"You can apply the BigPipe functionality to various elements in your application to enhance its interactivity and performance. Here are some examples of elements that can be ajaxified:"),Object(i.b)("h3",{id:"links"},"Links"),Object(i.b)("p",null,"You can ajaxify links using the ",Object(i.b)("inlineCode",{parentName:"p"},"ajaxify")," and ",Object(i.b)("inlineCode",{parentName:"p"},"rel")," attributes:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-html"}),'<a href="#"\n   ajaxify="/ajax/remove.php"\n   rel="async">Remove Item</a>\n')),Object(i.b)("h3",{id:"forms"},"Forms"),Object(i.b)("p",null,"Forms can be ajaxified by adding the ",Object(i.b)("inlineCode",{parentName:"p"},'rel="async"')," attribute and the appropriate ",Object(i.b)("inlineCode",{parentName:"p"},"action"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-html"}),'<form action="/submit.php"\n      method="POST"\n      rel="async">\n    <input name="user">\n    <input type="submit" name="Done">\n</form>\n')),Object(i.b)("h3",{id:"dialogs"},"Dialogs"),Object(i.b)("p",null,"Dialogs can also be ",Object(i.b)("inlineCode",{parentName:"p"},"ajaxified")," by using the ",Object(i.b)("inlineCode",{parentName:"p"},"ajaxify")," and ",Object(i.b)("inlineCode",{parentName:"p"},"rel")," attributes:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-html"}),'<a href="#"\n   ajaxify="/ajax/dialog.php"\n   rel="dialog">Open Dialog</a>\n')),Object(i.b)("p",null,"By ajaxifying these elements, you enable dynamic content loading and interaction without the need for full page reloads. This enhances the user experience by providing seamless and efficient updates to the page content."))}p.isMDXComponent=!0},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(n),d=a,m=u["".concat(s,".").concat(d)]||u[d]||b[d]||i;return n?r.a.createElement(m,o(o({ref:t},l),{},{components:n})):r.a.createElement(m,o({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,s=new Array(i);s[0]=d;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var l=2;l<i;l++)s[l]=n[l];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);